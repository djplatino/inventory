<!DOCTYPE html>
<html>
<head>
  <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
  <link href="/assets/css/all.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="/assets/css/jquery.dataTables.css">
  <link rel="stylesheet" type="text/css" href="/assets/css/dc.css"/>
  <script src="/assets/js/all.js"></script>
  <title>Retail Inventory Processing</title>
</head>
<body>
  <div class="container-fluid">
    <div class="row">
        <div class="col-10" id="message">
        </div>
        <div class="col-2 text-center">
          <span id="processing-indicator" style="font-size: 3em; color: green;" class="d-none">
            <i  class="fas fa-spinner fa-spin "></i>
          </span>
        </div>
    </div>
    <div class="row">
      <div class="col-sm-6">
          <input type="text" class="form-control" id="user-input" placeholder="input">
        </div>
        <div class="col-sm-6">
         <button type="button" id="action-button" class="btn btn-primary btn-block">Action</button>
       </div>
    </div>
    <div class="row">
      <div class="col-sm-6 col-md-3 col-lg-2">
        <button type="button" id="action-button-load-pbook" class="btn btn-primary btn-block">Load PBook</button>
      </div>
    </div>
    <div class="row">
      <div class="col-12">
        <button type="button" id="action-button-test" class="btn btn-primary btn-block">Test</button>
      </div>
    </div>


  </div>
  <script src="/socket.io/socket.io.js"></script>
  <script src="/assets/js/jquery-3.3.1.min.js"></script>
  <script src="/assets/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="/assets/js/d3.min.js"></script>
  <script type="text/javascript" src="/assets/js/crossfilter.js"></script>
  <script type="text/javascript" src="/assets/js/dc.js"></script>

  <script type="text/javascript" src="/assets/js/jquery.dataTables.js"></script>
  <script type="text/javascript" src="/assets/js/dc.datatables.js"></script>
  <script>
    $(function () {
      var socket = io();

      function updateMessage(classToSet, message){
        $("#message").empty();
        d3.select("#message")
        .append('div')
        .attr('class','alert alert-' + classToSet)
        .html(message);
      }

      $("#action-button").on('click',function(){
        //Every time the action button is triggered, the processing indicator
        //will be started. To stop the processing will wait for message from
        //the server

        //$("#processing-indicator").removeClass("d-none");
        //updateMessage("success", $("#user-input").val() + " started");

        var userAction = $('#user-input').val();
        $("action-task").empty();
        switch (userAction) {
          case "test":
            socket.emit('test', '{"action":"test","status":"success","message":"test"}');
            console.log("testing");
            break;
          case "upload":
            $('#upload-form-modal').modal('show')
            break;
          case "load":
            var msg = {"action":"load-item-master"};
            socket.emit('inventory', msg);
            break;
          case "load pbook":
              var msg = {"action":"load-pbook"};
              socket.emit('inventory', msg);
              break;
          case "process":
            var msg = {"action":"process-inventory"};
            socket.emit('inventory', msg);
            break;
          case "show itemMaster":
            var msg = {"action":"show-itemMaster"};
            socket.emit('inventory', msg);
            break;
          default:
            console.log("nothing to do");
        }
      });

      $("#action-button-load-pbook").on('click',function(){
        $("#user-input").val("load pbook");
        $("#action-button").click();
      });


      $("#action-button-test").on('click',function(){
        $("#user-input").val("test");
        $("#action-button").click();
      });


    });
  </script>
</body>
</html>
